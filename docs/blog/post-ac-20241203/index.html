<!DOCTYPE html>
<html lang="ja"><head>
  <meta charset="utf-8">
  <title>NUTMEG | é•·å²¡æŠ€è¡“ç§‘å­¦å¤§å­¦ æŠ€å¤§ç¥­å®Ÿè¡Œå§”å“¡ä¼š æƒ…å ±å±€</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="çš†æ§˜ã“ã‚“ã«ã¡ã¯ã€‚NUTMEGä¸‰å¹´ç›®ã®æ¯”å˜‰è¯ã§ã™ã€‚ã‚¢ãƒ‰ã‚«ãƒ¬3æ—¥ç›®ã«ãªã‚Šã¾ã™ã€‚ã¾ã åºã®ç« ã§ã‚ã‚Šã¾ã™ãŒæ˜¯éã”ä¸€èª­ãã ã•ã„ã€‚ ç§ãŸã¡ãŒBingoãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®é‹ç”¨ã‚’å§‹ã‚ã¦2å¹´ãŒçµŒã¡ã¾ã—ãŸã€‚ã‚³ãƒ¼ãƒ‰ã«é–¢ã—ã¦ã¯ã‚ã‚‹ç¨‹åº¦ã®å®Œæˆç³»ãŒè¦‹ãˆã¦ãŠã‚Šã€ã“ã‚Œã‹ã‚‰ã¯ã‚¤ãƒ³ãƒ•ãƒ©é–¢é€£ã§å®‰å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚æœ¬ãƒ–ãƒ­ã‚°ã§ã¯ã€Bingoãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹Hasura Engine v2ã®æ¦‚è¦ã¨æ§‹æˆã®ä¸€ä¾‹ã‚’å…±æœ‰ã—ã¾ã™ã€‚Hasuraè‡ªä½“ã®æ—¥æœ¬èªè¨˜äº‹ãŒå°‘ãªã„ &#43; ç§è‡ªèº«ã®Hasuraã®å¾©ç¿’ã‚‚å…¼ã­ã¦æ›¸ã„ã¦ã„ã¾ã™ã€‚ã“ã®æ§‹æˆãŒçµ¶å¯¾çš„ãªæ­£è§£ã¨ã„ã†ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã®ã§ã€ã‚ˆã‚Šè‰¯ã„æ–¹æ³•ãŒã‚ã‚Œã°ãœã²æ•™ãˆã¦ãã ã•ã„ã€‚">
  <meta name="author" content="NUTMEG">
  <meta name="generator" content="Hugo 0.127.0">

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://blog.nutmeg.cloud/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://blog.nutmeg.cloud/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://blog.nutmeg.cloud/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://blog.nutmeg.cloud/plugins/venobox/venobox.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://blog.nutmeg.cloud/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://blog.nutmeg.cloud/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://blog.nutmeg.cloud/images/favicon.png " type="image/x-icon">

  
  <link rel="stylesheet" href="https://blog.nutmeg.cloud/css/custom_post.css">
  

  <meta property="og:url" content="https://blog.nutmeg.cloud/blog/post-ac-20241203/">
  <meta property="og:site_name" content="NUTMEG | é•·å²¡æŠ€è¡“ç§‘å­¦å¤§å­¦ æŠ€å¤§ç¥­å®Ÿè¡Œå§”å“¡ä¼š æƒ…å ±å±€">
  <meta property="og:title" content="hasura v2ã®ã™ã‚ã‚">
  <meta property="og:description" content="çš†æ§˜ã“ã‚“ã«ã¡ã¯ã€‚NUTMEGä¸‰å¹´ç›®ã®æ¯”å˜‰è¯ã§ã™ã€‚ã‚¢ãƒ‰ã‚«ãƒ¬3æ—¥ç›®ã«ãªã‚Šã¾ã™ã€‚ã¾ã åºã®ç« ã§ã‚ã‚Šã¾ã™ãŒæ˜¯éã”ä¸€èª­ãã ã•ã„ã€‚ ç§ãŸã¡ãŒBingoãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®é‹ç”¨ã‚’å§‹ã‚ã¦2å¹´ãŒçµŒã¡ã¾ã—ãŸã€‚ã‚³ãƒ¼ãƒ‰ã«é–¢ã—ã¦ã¯ã‚ã‚‹ç¨‹åº¦ã®å®Œæˆç³»ãŒè¦‹ãˆã¦ãŠã‚Šã€ã“ã‚Œã‹ã‚‰ã¯ã‚¤ãƒ³ãƒ•ãƒ©é–¢é€£ã§å®‰å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚æœ¬ãƒ–ãƒ­ã‚°ã§ã¯ã€Bingoãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹Hasura Engine v2ã®æ¦‚è¦ã¨æ§‹æˆã®ä¸€ä¾‹ã‚’å…±æœ‰ã—ã¾ã™ã€‚Hasuraè‡ªä½“ã®æ—¥æœ¬èªè¨˜äº‹ãŒå°‘ãªã„ &#43; ç§è‡ªèº«ã®Hasuraã®å¾©ç¿’ã‚‚å…¼ã­ã¦æ›¸ã„ã¦ã„ã¾ã™ã€‚ã“ã®æ§‹æˆãŒçµ¶å¯¾çš„ãªæ­£è§£ã¨ã„ã†ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã®ã§ã€ã‚ˆã‚Šè‰¯ã„æ–¹æ³•ãŒã‚ã‚Œã°ãœã²æ•™ãˆã¦ãã ã•ã„ã€‚">
  <meta property="og:locale" content="ja">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-12-03T11:01:12+09:00">
    <meta property="article:modified_time" content="2024-12-03T11:01:12+09:00">
    <meta property="article:tag" content="TypeScript">
    <meta property="article:tag" content="Next.js">
    <meta property="article:tag" content="Docker">
    <meta property="article:tag" content="Hasura">
    <meta property="article:tag" content="ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰">
    <meta property="article:tag" content="APIé–¢ä¿‚">
    <meta property="og:image" content="https://blog.nutmeg.cloud/images/OGP.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://blog.nutmeg.cloud/images/OGP.png">
  <meta name="twitter:title" content="hasura v2ã®ã™ã‚ã‚">
  <meta name="twitter:description" content="çš†æ§˜ã“ã‚“ã«ã¡ã¯ã€‚NUTMEGä¸‰å¹´ç›®ã®æ¯”å˜‰è¯ã§ã™ã€‚ã‚¢ãƒ‰ã‚«ãƒ¬3æ—¥ç›®ã«ãªã‚Šã¾ã™ã€‚ã¾ã åºã®ç« ã§ã‚ã‚Šã¾ã™ãŒæ˜¯éã”ä¸€èª­ãã ã•ã„ã€‚ ç§ãŸã¡ãŒBingoãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®é‹ç”¨ã‚’å§‹ã‚ã¦2å¹´ãŒçµŒã¡ã¾ã—ãŸã€‚ã‚³ãƒ¼ãƒ‰ã«é–¢ã—ã¦ã¯ã‚ã‚‹ç¨‹åº¦ã®å®Œæˆç³»ãŒè¦‹ãˆã¦ãŠã‚Šã€ã“ã‚Œã‹ã‚‰ã¯ã‚¤ãƒ³ãƒ•ãƒ©é–¢é€£ã§å®‰å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚æœ¬ãƒ–ãƒ­ã‚°ã§ã¯ã€Bingoãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹Hasura Engine v2ã®æ¦‚è¦ã¨æ§‹æˆã®ä¸€ä¾‹ã‚’å…±æœ‰ã—ã¾ã™ã€‚Hasuraè‡ªä½“ã®æ—¥æœ¬èªè¨˜äº‹ãŒå°‘ãªã„ &#43; ç§è‡ªèº«ã®Hasuraã®å¾©ç¿’ã‚‚å…¼ã­ã¦æ›¸ã„ã¦ã„ã¾ã™ã€‚ã“ã®æ§‹æˆãŒçµ¶å¯¾çš„ãªæ­£è§£ã¨ã„ã†ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã®ã§ã€ã‚ˆã‚Šè‰¯ã„æ–¹æ³•ãŒã‚ã‚Œã°ãœã²æ•™ãˆã¦ãã ã•ã„ã€‚">


  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
  </script>

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q71WVEHHBF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

  gtag('config', 'G-Q71WVEHHBF');
  </script>
</head>
<body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://blog.nutmeg.cloud/"><img class="img-fluid"
          src="https://blog.nutmeg.cloud/images/NUTMEG-logo_all_color_horizontal.png" alt="NUTMEG | é•·å²¡æŠ€è¡“ç§‘å­¦å¤§å­¦ æŠ€å¤§ç¥­å®Ÿè¡Œå§”å“¡ä¼š æƒ…å ±å±€"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu h3"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://twitter.com/nutfes_nutmeg"><i class="ti-twitter-alt"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.instagram.com/nutfes/?hl=ja"><i class="ti-instagram"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/orgs/NUTFes"><i class="ti-github"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://blog.nutmeg.cloud/"><img class="img-fluid"
            src="https://blog.nutmeg.cloud/images/NUTMEG-logo_all_color_horizontal.png" alt="NUTMEG | é•·å²¡æŠ€è¡“ç§‘å­¦å¤§å­¦ æŠ€å¤§ç¥­å®Ÿè¡Œå§”å“¡ä¼š æƒ…å ±å±€"></a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://blog.nutmeg.cloud/about">About</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://blog.nutmeg.cloud/blog">Post</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://blog.nutmeg.cloud/products">Products</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://blog.nutmeg.cloud/members">Members</a>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://blog.nutmeg.cloud//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        
        <a href="https://blog.nutmeg.cloud/categories/nutmeg-advent-calendar-2024"
          class="text-primary">Nutmeg advent calendar 2024</a>
        
        <a href="https://blog.nutmeg.cloud/categories/%e3%83%a1%e3%83%b3%e3%83%90%e3%83%bc%e3%81%ae%e8%b6%a3%e5%91%b3"
          class="text-primary">ãƒ¡ãƒ³ãƒãƒ¼ã®è¶£å‘³</a>
        
        <a href="https://blog.nutmeg.cloud/categories/%e6%b4%bb%e5%8b%95%e3%81%ae%e6%a7%98%e5%ad%90"
          class="text-primary">æ´»å‹•ã®æ§˜å­</a>
        
        <h2>hasura v2ã®ã™ã‚ã‚</h2>
        <div class="mb-3 post-meta">
          <span class="author">
            
            
            <p>
              
              
              By æ¯”å˜‰è¯
              
              
              
              
              <span class="border-bottom border-primary px-2 mx-1"></span>
              03 December 2024
              
            </p>
          </span>
        </div>
        
        <img src="https://hackmd.io/_uploads/B1A1QhFXyx.png" class="img-fluid w-100 mb-4" alt="hasura v2ã®ã™ã‚ã‚">
        
        <div class="content mb-5">
          <h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«</h2>
<p>çš†æ§˜ã“ã‚“ã«ã¡ã¯ã€‚NUTMEG 3å¹´ç›®ã®æ¯”å˜‰è¯ã§ã™ã€‚ã‚¢ãƒ‰ã‚«ãƒ¬3æ—¥ç›®ã«ãªã‚Šã¾ã™ã€‚ã¾ã åºã®ç« ã§ã‚ã‚Šã¾ã™ãŒæ˜¯éã”ä¸€èª­ãã ã•ã„ã€‚
ç§ãŸã¡ãŒBingoãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®é‹ç”¨ã‚’å§‹ã‚ã¦2å¹´ãŒçµŒã¡ã¾ã—ãŸã€‚ã‚³ãƒ¼ãƒ‰ã«é–¢ã—ã¦ã¯ã‚ã‚‹ç¨‹åº¦ã®å®Œæˆç³»ãŒè¦‹ãˆã¦ãŠã‚Šã€ã“ã‚Œã‹ã‚‰ã¯ã‚¤ãƒ³ãƒ•ãƒ©é–¢é€£ã§å®‰å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚æœ¬ãƒ–ãƒ­ã‚°ã§ã¯ã€Bingoãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹Hasura Engine v2ã®æ¦‚è¦ã¨æ§‹æˆã®ä¸€ä¾‹ã‚’å…±æœ‰ã—ã¾ã™ã€‚<strong>Hasuraè‡ªä½“ã®æ—¥æœ¬èªè¨˜äº‹ãŒå°‘ãªã„ + ç§è‡ªèº«ã®Hasuraã®å¾©ç¿’ã‚‚å…¼ã­ã¦æ›¸ã„ã¦ã„ã¾ã™ã€‚ã“ã®æ§‹æˆãŒçµ¶å¯¾çš„ãªæ­£è§£ã¨ã„ã†ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã®ã§ã€ã‚ˆã‚Šè‰¯ã„æ–¹æ³•ãŒã‚ã‚Œã°ãœã²æ•™ãˆã¦ãã ã•ã„ã€‚</strong></p>
<h2 id="hasura-graphql-engineã¨ã¯">Hasura GraphQL Engineã¨ã¯</h2>
<p>ä»¥ä¸‹ã¯<a href="https://hasura.io/docs/2.0/index/">å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã®ç¿»è¨³ã§ã™ã€‚
Hasura GraphQL Engineã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’å³åº§ã«GraphQL APIã¨ã—ã¦åˆ©ç”¨å¯èƒ½ã«ã—ã€ãƒ¢ãƒ€ãƒ³ã§é«˜æ€§èƒ½ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„APIã‚’å¾“æ¥ã®10å€ã®é€Ÿã•ã§æ§‹ç¯‰ãƒ»æä¾›ã§ãã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚Hasuraã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€RESTãŠã‚ˆã³GraphQLã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£APIã«æ¥ç¶šã—ã€ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦çµ±åˆã•ã‚ŒãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã‚»ã‚­ãƒ¥ã‚¢ãªGraphQL APIã‚’æä¾›ã—ã¾ã™ã€‚Hasuraã®ã‚³ã‚¢æ©Ÿèƒ½ã¯ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã§é–‹ç™ºã•ã‚Œã¦ãŠã‚Šã€èª°ã§ã‚‚ç„¡æ–™ã§ä½¿ç”¨ã§ãã¾ã™ã€‚</p>
<p>è¦ã™ã‚‹ã«ã€Hasura Engineï¼ˆä»¥ä¸‹ã€Hasuraï¼‰ã¯ã€PostgreSQLã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è‡ªå‹•çš„ã«GraphQLã‚µãƒ¼ãƒãƒ¼ã‚’æ§‹ç¯‰ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚Hasuraã‚’ä½¿ç”¨ã™ã‚‹éš›ã¯ã€Hasuraã¨PostgreSQLã‚’çµ„ã¿åˆã‚ã›ã¦åˆ©ç”¨ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚ãªãŠã€<em><strong>ã€ŒHasuraã€ã¯ã€Œé˜¿ä¿®ç¾…ï¼ˆAshuraï¼‰ã€ã¨Haskellã‚’çµ„ã¿åˆã‚ã›ãŸé€ èªã§ã™ã€‚</strong></em></p>
<p>HasuraãŒè‡ªå‹•ã§GraphQLã‚µãƒ¼ãƒãƒ¼ã¨ã—ã¦å‹•ä½œã™ã‚‹ãŸã‚ã€GraphQLã‚µãƒ¼ãƒãƒ¼ã‚’å®Ÿè£…ã™ã‚‹æ‰‹é–“ãŒçœã‘ã¾ã™ã€‚Hasuraã§è¨­å®šã™ã‚Œã°ã€ã™ãã«Queryã€Mutationã€Subscriptionã‚’ä½¿ãˆã‚‹ãŸã‚ã€é«˜ã„é–‹ç™ºåŠ¹ç‡ã§é–‹ç™ºã‚’é€²ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚Hasuraã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã€ã‚¯ã‚¨ãƒªã«æ²¿ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’GraphQL Code Generatorã§è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã®ã§ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å®Ÿè£…ã‚’ç°¡å˜ã«è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<p>ã¾ãŸã€Hasuraã§ã¯Auth0ãªã©ã®èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ã¨é€šä¿¡ã—ã€JWTã‚’åˆ©ç”¨ã—ã¦ã€å„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚„ã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ãƒ¼ãƒ«ã‚„IDã«åŸºã¥ãè©³ç´°ãªã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’è¨­å®šã§ãã¾ã™ã€‚JWTã«å«ã¾ã‚Œã‚‹ <code>X-Hasura-User-Id</code> ã‚’ä½¿ç”¨ã—ã¦ã€ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªèº«ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’å–å¾—ãƒ»æ“ä½œã§ãã‚‹ã‚ˆã†ã«åˆ¶é™ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚</p>
<h2 id="hasuraã®ç’°å¢ƒæ§‹ç¯‰">Hasuraã®ç’°å¢ƒæ§‹ç¯‰</h2>
<p>Dockerç’°å¢ƒã§ã®Hasuraã®ç’°å¢ƒæ§‹ç¯‰ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚ã“ã®æ‰‹é †ã‚’è¸ã‚€ã“ã¨ã§ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ã™ã¹ã¦Hasuraã«ä¸€ä»»ã§ãã‚‹ã§ã—ã‚‡ã†ã€‚</p>
<p>Bingoãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‹ã‚‰å¿…è¦ãªã‚‚ã®ã ã‘ã‚’æŠ½å‡ºã—ã¦ç°¡ç´ åŒ–ã—ã¦ã„ã‚‹ãŸã‚ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯ã‚ã¾ã‚Šå‚è€ƒã«ã—ãªã„ã§ãã ã•ã„ã€‚æœ¬æ¥ã¯ã€App Routerã®ä½¿ç”¨ã‚„pnpmã§ã®ç®¡ç†ãªã©ã‚’è¡Œã£ãŸæ–¹ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ï¼</p>
<p>æœ¬æ§‹æˆã®ç‰¹å¾´ã¯ã€<code>docker compose build</code>ãŒä¸è¦ã«ãªã‚‹ã“ã¨ã§ã™ã€‚ãŸã ã—ã€ä½¿ã„å‹æ‰‹ã¯æ­£ç›´ã‚ã¾ã‚Šè‰¯ãã‚ã‚Šã¾ã›ã‚“ã€‚èµ·å‹•ã®ãŸã³ã«<code>npm ciã€npm run</code>ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ã‹ã‚‰å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•ã¾ã§ç´„1åˆ†ã‹ã‹ã‚Šã¾ã™ã€‚</p>
<h3 id="æœ€çµ‚çš„ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ-appã¯è§¦ã£ãŸéƒ¨åˆ†ã®ã¿ã‚’æ²è¼‰">æœ€çµ‚çš„ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ â€»appã¯è§¦ã£ãŸéƒ¨åˆ†ã®ã¿ã‚’æ²è¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">ğŸ“api
</span></span><span class="line"><span class="cl">    ğŸ“metadata
</span></span><span class="line"><span class="cl">    ğŸ“migrations/default/hoge_auto
</span></span><span class="line"><span class="cl">        ğŸ“„up.sql
</span></span><span class="line"><span class="cl">    ğŸ“seed
</span></span><span class="line"><span class="cl">    ğŸ“„config.yaml
</span></span><span class="line"><span class="cl">ğŸ“app
</span></span><span class="line"><span class="cl">    ğŸ“src
</span></span><span class="line"><span class="cl">        ğŸ“gql
</span></span><span class="line"><span class="cl">            ğŸ“„users.gql
</span></span><span class="line"><span class="cl">        ğŸ“pages
</span></span><span class="line"><span class="cl">            ğŸ“„_app.tsx
</span></span><span class="line"><span class="cl">            ğŸ“„index.tsx
</span></span><span class="line"><span class="cl">        ğŸ“type
</span></span><span class="line"><span class="cl">            ğŸ“„graphql.ts
</span></span><span class="line"><span class="cl">    ğŸ“„.eslintrc.json
</span></span><span class="line"><span class="cl">    ğŸ“„next.config.ts
</span></span><span class="line"><span class="cl">    ğŸ“„codegen.ts
</span></span><span class="line"><span class="cl">ğŸ“settings
</span></span><span class="line"><span class="cl">    ğŸ“„.env
</span></span><span class="line"><span class="cl">ğŸ“„compose.yaml
</span></span><span class="line"><span class="cl">ğŸ“„.gitignore
</span></span><span class="line"><span class="cl">ğŸ“„Makefile</span></span></code></pre></div>
<p><a href="https://github.com/hikahana/hasura_v3">Githubã«æŒ™ã’ãŸã‚‚ã®ã¯ã“ã¡ã‚‰ã§ã™ã€‚</a></p>
<p>GitHubä¸Šã®ãƒªãƒã‚¸ãƒˆãƒªä½œæˆã¨first commitã¯å®Œäº†ã—ã¦ã„ã‚‹å‰æã§é€²ã‚ã¾ã™ã€‚ãƒªãƒã‚¸ãƒˆãƒªã®ä½œæˆã«ã¤ã„ã¦ä¸æ˜ãªæ–¹ã¯ã€<a href="https://docs.github.com/ja/repositories/creating-and-managing-repositories/creating-a-new-repository">å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
<h3 id="1-compose-upã™ã‚‹ãŸã‚ã®æº–å‚™">1. compose upã™ã‚‹ãŸã‚ã®æº–å‚™</h3>
<p>1.1
ã¾ãšã€compose.yamlã‚’ä½œæˆã—ã€ä½¿ç”¨ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã®æƒ…å ±ã‚’å®šç¾©ã—ã¾ã™ã€‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯Nextjsã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯Hasuraã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯PostgreSQLã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ã“ã‚Œã‚‰ã‚’å®šç¾©ã—ã¾ã™ã€‚</p>
<p>(ä»¥ä¸‹ã€compose.yamlã®å†…å®¹)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">db</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres:12</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;db&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;5432:5432&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">db-data:/var/lib/postgresql/data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">POSTGRES_DB</span><span class="p">:</span><span class="w"> </span><span class="l">db</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">POSTGRES_USER</span><span class="p">:</span><span class="w"> </span><span class="l">user</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">POSTGRES_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l">password</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">POSTGRES_HOST_AUTH_METHOD</span><span class="p">:</span><span class="w"> </span><span class="l">trust</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">healthcheck</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">test</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="s2">&#34;CMD-SHELL&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="s2">&#34;pg_isready&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l">10s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l">5s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">api</span><span class="p">:</span><span class="w"> </span><span class="c"># hasura</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">hasura/graphql-engine:v2.36.6@sha256:3fc234510962e66d5ca7db16734b8796a16fb729953915861953e974f976f30f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;api&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;8080:8080&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">./api:/hasura/api</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">working_dir</span><span class="p">:</span><span class="w"> </span><span class="l">/hasura/api</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">./settings/.env</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="p">&gt;</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">      sh -c &#34;
</span></span></span><span class="line"><span class="cl"><span class="sd">      curl -L https://github.com/hasura/graphql-engine/raw/stable/cli/get.sh | bash &amp;&amp;
</span></span></span><span class="line"><span class="cl"><span class="sd">      graphql-engine serve
</span></span></span><span class="line"><span class="cl"><span class="sd">      &#34;</span><span class="w">      
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">app</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">node:20-alpine@sha256:b5b9467fe7b33aad47f1ec3f6e0646a658f85f05c18d4243024212a91f3b7554</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;app&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">./app:/app</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">working_dir</span><span class="p">:</span><span class="w"> </span><span class="l">/app</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">sh -c &#34;npm ci &amp;&amp; npm run dev&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;3000:3000&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">./settings/.env</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">stdin_open</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tty</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">db-data</span><span class="p">:</span><span class="w">
</span></span></span></code></pre></div><hr>
<p>1.2
ç’°å¢ƒå¤‰æ•°ã‚’é…ç½®ã™ã‚‹ãŸã‚ã€è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚compose.yamlã‚’ç¢ºèªã™ã‚‹ã¨ã€apiã¨appã®ç’°å¢ƒå¤‰æ•°ã¯<code>settings/.env</code>ã‚’å‚ç…§ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã§</span>
</span></span><span class="line"><span class="cl">mkdir settings
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> settings
</span></span><span class="line"><span class="cl">touch .env
</span></span></code></pre></div><p>.envãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
(ä»¥ä¸‹ã€.envã®å†…å®¹)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-env" data-lang="env"><span class="line"><span class="cl"><span class="nv">NEXT_PUBLIC_CSR_API_URL</span><span class="o">=</span><span class="s2">&#34;http://localhost:8080&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">NEXT_PUBLIC_SSR_API_URL</span><span class="o">=</span><span class="s2">&#34;http://api:8080&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">NEXT_PUBLIC_BASE_URL</span><span class="o">=</span><span class="s2">&#34;http://localhost:8080&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">API_URI</span><span class="o">=</span><span class="s2">&#34;http://localhost:8080&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">WATCHPACK_POLLING</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">WS_API_URL</span><span class="o">=</span><span class="s2">&#34;ws://localhost:8080&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">HASURA_GRAPHQL_ENABLE_CONSOLE</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;postgres://{db_user_name}:{db_user_password}@{seivice_name}:{db_port}/{db_name}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">HASURA_GRAPHQL_DATABASE_URL</span><span class="o">=</span><span class="s2">&#34;postgres://user:password@db:5432/db&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">HASURA_GRAPHQL_DEV_MODE</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">HASURA_GRAPHQL_ENABLED_LOG_TYPES</span><span class="o">=</span><span class="s2">&#34;startup, http-log, webhook-log, websocket-log, query-log&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">HASURA_GRAPHQL_EXPERIMENTAL_FEATURES</span><span class="o">=</span><span class="s2">&#34;naming_convention&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">HASURA_GRAPHQL_CLI_ENVIRONMENT</span><span class="o">=</span><span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">HASURA_GRAPHQL_ADMIN_SECRET</span><span class="o">=</span><span class="s2">&#34;hogehoge&#34;</span>
</span></span></code></pre></div><p>â€»æ³¨æ„ç‚¹
<strong>HASURA_GRAPHQL_DATABASE_URL</strong>ã¯compose.yamlã®dbã®enviromentã§å®šç¾©ã—ãŸã‚‚ã®ã¨åŒä¸€ã«ã—ã¦ãã ã•ã„ã€‚ãã†ã§ãªã„ã¨dbã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒã§ãã¾ã›ã‚“ã€‚
<strong>HASURA_GRAPHQL_ADMIN_SECRET</strong>ã¯é©å®œä¿®æ­£ã—ã¦ãã ã•ã„ã€‚</p>
<hr>
<p>1.3
gitã«ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãªã„ã‚ˆã†ã€.gitignoreãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<p>(ä»¥ä¸‹ã€.gitignoreã®å†…å®¹)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">settings/
</span></span></code></pre></div><hr>
<p>1.4
Nextjsã®ç’°å¢ƒæ§‹ç¯‰ã‚’è¡Œã„ã¾ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ã€‚</p>
<p>(ä»¥ä¸‹ã€Next.jsã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®å¯¾è©±å‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">npx create-next-app@latest app
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Need to install the following packages:
</span></span><span class="line"><span class="cl">  create-next-app@15.0.3
</span></span><span class="line"><span class="cl">Ok to proceed? <span class="o">(</span>y<span class="o">)</span> y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">âœ” Would you like to use TypeScript? â€¦ No / Yes
</span></span><span class="line"><span class="cl">âœ” Would you like to use ESLint? â€¦ No / Yes
</span></span><span class="line"><span class="cl">âœ” Would you like to use Tailwind CSS? â€¦ No / Yes
</span></span><span class="line"><span class="cl">âœ” Would you like your code inside a <span class="sb">`</span>src/<span class="sb">`</span> directory? â€¦ No / Yes
</span></span><span class="line"><span class="cl">âœ” Would you like to use App Router? <span class="o">(</span>recommended<span class="o">)</span> â€¦ No / Yes
</span></span><span class="line"><span class="cl">âœ” Would you like to use Turbopack <span class="k">for</span> next dev? â€¦ No / Yes
</span></span><span class="line"><span class="cl">âœ” Would you like to customize the import <span class="nb">alias</span> <span class="o">(</span>@/* by default<span class="o">)</span>? â€¦ No / Yes
</span></span><span class="line"><span class="cl">âœ” What import <span class="nb">alias</span> would you like configured? â€¦ @/*
</span></span></code></pre></div><hr>
<p>1.5
æœ€å¾Œã«ã€Makefileã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã‚Œã¯å¾Œã®Hasuraæ“ä½œã§ä½¿ç”¨ã—ã¾ã™ã€‚</p>
<p>(ä»¥ä¸‹ã€Makefileã®å†…å®¹)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-makefile" data-lang="makefile"><span class="line"><span class="cl"><span class="nf">run</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	docker compose up -d
</span></span><span class="line"><span class="cl">	sleep <span class="m">10</span>
</span></span><span class="line"><span class="cl">	make db-apply
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">down</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	docker compose down
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">db/apply</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	docker compose <span class="nb">exec</span> api hasura metadata apply
</span></span><span class="line"><span class="cl">	docker compose <span class="nb">exec</span> api hasura migrate apply --database-name default
</span></span><span class="line"><span class="cl">	docker compose <span class="nb">exec</span> api hasura metadata reload
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">db/export</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	docker compose <span class="nb">exec</span> api hasura metadata <span class="nb">export</span>
</span></span><span class="line"><span class="cl">	docker compose <span class="nb">exec</span> api hasura migrate create <span class="s2">&#34;auto&#34;</span> --from-server --database-name default
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">db/seed</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	docker compose <span class="nb">exec</span> api hasura seed apply
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">codegen</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	docker compose run --rm app npm run codegen
</span></span></code></pre></div><h3 id="2-hasuraã®èµ·å‹•">2. Hasuraã®èµ·å‹•</h3>
<p>2.1
compose upå‰ã«å¿…è¦ãªæº–å‚™ãŒæ•´ã£ãŸã®ã§ã€å®Ÿéš›ã«ã‚³ãƒ³ãƒ†ãƒŠã‚’ç«‹ã¡ä¸Šã’ã€Hasuraã®åˆæœŸèµ·å‹•ã‚’è¡Œã„ã¾ã™ã€‚</p>
<p>Hasura CLIã‚’ä½¿ç”¨ã—ã¦Hasuraã®ç’°å¢ƒã‚’ä½œæˆã—ã¾ã™ã€‚ä»Šå›ã¯ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã€<code>docker compose run --rm</code>ã§ã¯ã†ã¾ãå‹•ä½œã—ã¾ã›ã‚“ã€‚</p>
<p><code>hasura init --directory .</code>ã§åˆæœŸåŒ–ã®å ´æ‰€ã‚’æŒ‡å®šã§ãã¾ã™ã€‚ä»Šå›ã¯compose upã®éš›ã«apiãƒ•ã‚©ãƒ«ãƒ€ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãã“ã«åˆæœŸåŒ–ã•ã›ã¾ã™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker compose up -d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker compose <span class="nb">exec</span> api hasura init --directory .
</span></span></code></pre></div><hr>
<p>2.2
åˆæœŸåŒ–ãŒæˆåŠŸã—ãŸã‚‰ã€<code>localhost:8080/console</code>ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦usersã‚¹ã‚­ãƒ¼ãƒã‚’ä½œæˆã—ã¾ã™ã€‚ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹éš›ã¯ã€.envãƒ•ã‚¡ã‚¤ãƒ«ã§è¨­å®šã—ãŸADMIN_SECRETãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚</p>
<p>ç”»é¢ä¸Šéƒ¨ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‹ã‚‰<strong>DATA</strong>ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ãã®å¾Œã€ŒCreate tableã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ç”»åƒã‚’å‚è€ƒã«ã€usersã‚¹ã‚­ãƒ¼ãƒã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚created_atã¨updated_atã¯ã€ã€ŒFrequently used columnsã€ã‹ã‚‰é¸æŠã§ãã¾ã™ã€‚
<img src="https://hackmd.io/_uploads/HyzL_ntXJg.png" alt="image (2)">
<img src="https://hackmd.io/_uploads/BkO8d2KX1g.jpg" alt="Add Table - Data _ Hasura_page-0001">
<img src="https://hackmd.io/_uploads/SJ0LOnYXJe.png" alt="image (3)"></p>
<hr>
<p>2.3
ã‚¹ã‚­ãƒ¼ãƒã®ä½œæˆãŒå®Œäº†ã—ãŸã‚‰ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç§»è¡Œã¨ç¾åœ¨ã®ã‚¹ã‚­ãƒ¼ãƒã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’è¡Œã„ã¾ã™ã€‚å…ˆã»ã©ä½œæˆã—ãŸMakeã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make db/export
</span></span><span class="line"><span class="cl">make db/apply
</span></span></code></pre></div><h3 id="3-graphql-code-generatorã®å°å…¥">3. GraphQL Code Generatorã®å°å…¥</h3>
<p>3.1
Hasuraã¨Next.jsã®ç’°å¢ƒãŒæ•´ã£ãŸã®ã§ã€æœ€å¾Œã«Code Generatorã§è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚</p>
<p>å¿…è¦ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker compose run --rm app npm install --save-dev <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  @graphql-codegen/cli <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  graphql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  @graphql-codegen/client-preset <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  @graphql-codegen/typescript <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  @graphql-codegen/typescript-graphql-request <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  @graphql-codegen/typescript-operations <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  @graphql-codegen/typescript-react-apollo <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  prettier
</span></span></code></pre></div><hr>
<p>3.2
æ¬¡ã«ã€Code Generatorã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚å¯¾è©±å‹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã«å¾“ã„ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ã¾ã™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker compose run app npx graphql-codegen init
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Welcome to GraphQL Code Generator!
</span></span><span class="line"><span class="cl">    Answer few questions and we will setup everything <span class="k">for</span> you.
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">? What <span class="nb">type</span> of application are you building? Application built with React
</span></span><span class="line"><span class="cl">? Where is your schema?: <span class="o">(</span>path or url<span class="o">)</span> http:localhost:8080
</span></span><span class="line"><span class="cl">? Where are your operations and fragments?: src/gql/*.gql
</span></span><span class="line"><span class="cl">? Where to write the output: type/
</span></span><span class="line"><span class="cl">? Do you want to generate an introspection file? Yes
</span></span><span class="line"><span class="cl">? How to name the config file? codegen.ts
</span></span><span class="line"><span class="cl">? What script in package.json should run the codegen? codegen
</span></span><span class="line"><span class="cl">Fetching latest versions of selected plugins...
</span></span></code></pre></div><p>initå¾Œã€ä»¥ä¸‹ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚
(ä»¥ä¸‹ã€codegen.tsã®å†…å®¹)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">config</span> <span class="kr">as</span> <span class="nx">dotenvConfig</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;dotenv&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CodegenConfig</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@graphql-codegen/cli&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">dotenvConfig</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">config</span>: <span class="kt">CodegenConfig</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">overwrite</span>: <span class="kt">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">schema</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;http://api:8080/v1/graphql&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;x-hasura-admin-secret&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">HASURA_GRAPHQL_ADMIN_SECRET</span> <span class="o">||</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">documents</span><span class="o">:</span> <span class="s2">&#34;src/gql/*.gql&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">hooks</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">afterAllFileWrite</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;prettier --write&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nx">generates</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;./src/type/graphql.ts&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;typescript&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;typescript-operations&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;typescript-react-apollo&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nx">config</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">namingConvention</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">typeNames</span><span class="o">:</span> <span class="s2">&#34;change-case-all#pascalCase&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nx">enumValues</span><span class="o">:</span> <span class="s2">&#34;change-case-all#camelCase&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nx">fieldNames</span><span class="o">:</span> <span class="s2">&#34;change-case-all#camelCase&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">transformUnderscore</span><span class="o">:</span> <span class="s2">&#34;true&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">gqlImport</span><span class="o">:</span> <span class="s2">&#34;@apollo/client#gql&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">withHooks</span>: <span class="kt">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">withHOC</span>: <span class="kt">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">withComponent</span>: <span class="kt">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">config</span><span class="p">;</span>
</span></span></code></pre></div><hr>
<p>3.3
GraphQLã‚¯ã‚¨ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir gql
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> gql
</span></span><span class="line"><span class="cl">touch users.gql
</span></span></code></pre></div><p>(ä»¥ä¸‹ã€users.gqlã®å†…å®¹)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gql" data-lang="gql"><span class="line"><span class="cl"><span class="kd">query</span><span class="w"> </span><span class="nc">GetUsers</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="py">users</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">created_at</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">updated_at</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">mutation</span><span class="w"> </span><span class="nc">CreateUser</span><span class="p">(</span><span class="nv">$name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">!)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="py">insert_users_one</span><span class="p">(</span><span class="py">object</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nc">name</span><span class="p">:</span><span class="w"> </span><span class="nv">$name</span><span class="p">})</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nc">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">mutation</span><span class="w"> </span><span class="nc">UpdateUser</span><span class="p">(</span><span class="nv">$id</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">!,</span><span class="w"> </span><span class="nv">$name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">!)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="py">update_users_by_pk</span><span class="p">(</span><span class="py">pk_columns</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nc">id</span><span class="p">:</span><span class="w"> </span><span class="nv">$id</span><span class="p">},</span><span class="w"> </span><span class="nc">_set</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nc">name</span><span class="p">:</span><span class="w"> </span><span class="nv">$name</span><span class="p">})</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nc">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">mutation</span><span class="w"> </span><span class="nc">DeleteUser</span><span class="p">(</span><span class="nv">$id</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">!)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="py">delete_users_by_pk</span><span class="p">(</span><span class="py">id</span><span class="p">:</span><span class="w"> </span><span class="nv">$id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nc">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><hr>
<p>3.4
ESLintã®è¨­å®šã‚’ä¿®æ­£ã—ã¾ã™ã€‚</p>
<p>(ä»¥ä¸‹ã€.eslintrc.jsonã®å†…å®¹)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;extends&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;next/core-web-vitals&#34;</span><span class="p">,</span> <span class="s2">&#34;next/typescript&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;overrides&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;files&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;app/src/type/*&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;rules&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;no-unused-vars&#34;</span><span class="p">:</span> <span class="s2">&#34;off&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;other-rule&#34;</span><span class="p">:</span> <span class="s2">&#34;off&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<p>3.5
æœ€å¾Œã«ã€å‹å®šç¾©ã¨ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make codegen
</span></span></code></pre></div><h3 id="4-å‹•ä½œç¢ºèª">4. å‹•ä½œç¢ºèª</h3>
<p>4.1
src/pagesã«ã‚ã‚‹_app.tsxã¨index.tsxã‚’ä¿®æ­£ã—ã¾ã™ã€‚app.tsxã§ApolloProviderã§å›²ã¾ãªã„ã¨ã‚¨ãƒ©ãƒ¼ãŒè¿”ã£ã¦ãã¦ã—ã¾ã†ã®ã§å¿˜ã‚Œãšã«è¡Œã„ã¾ã—ã‚‡ã†ã€‚</p>
<p>(ä»¥ä¸‹ã€_app.tsxã®å†…å®¹)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-tsx" data-lang="tsx"><span class="line"><span class="cl"><span class="kr">import</span> <span class="s2">&#34;@/styles/globals.css&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="kr">type</span> <span class="p">{</span> <span class="nx">AppProps</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;next/app&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">ApolloProvider</span><span class="p">,</span> <span class="nx">ApolloClient</span><span class="p">,</span> <span class="nx">InMemoryCache</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@apollo/client&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">GraphQLWsLink</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@apollo/client/link/subscriptions&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createClient</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;graphql-ws&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">wsClient</span> <span class="o">=</span> <span class="nx">createClient</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span>: <span class="kt">process.env.WS_API_URL</span> <span class="o">+</span> <span class="s2">&#34;/v1/graphql&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">connectionParams</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;x-hasura-admin-secret&#34;</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">HASURA_GRAPHQL_ADMIN_SECRET</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å«ã‚“ã  websocket ãƒªãƒ³ã‚¯ã‚’ä½œæˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">wsLink</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GraphQLWsLink</span><span class="p">(</span><span class="nx">wsClient</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Apollo client ã‚’ä½œæˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ApolloClient</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">link</span>: <span class="kt">wsLink</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">cache</span>: <span class="kt">new</span> <span class="nx">InMemoryCache</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">App</span><span class="p">({</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">pageProps</span> <span class="p">}</span><span class="o">:</span> <span class="nx">AppProps</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">ApolloProvider</span> <span class="na">client</span><span class="o">=</span><span class="p">{</span><span class="nx">client</span><span class="p">}&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">Component</span> <span class="p">{</span><span class="na">...pageProps</span><span class="p">}</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">ApolloProvider</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>(ä»¥ä¸‹ã€index.tsxã®å†…å®¹)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-tsx" data-lang="tsx"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">useSubscription</span><span class="p">,</span> <span class="nx">useMutation</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@apollo/client&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">SubscriptionUsersSubscription</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">CreateUserMutation</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">UpdateUserMutation</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">DeleteUserMutation</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">SubscriptionUsersDocument</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">CreateUserDocument</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">UpdateUserDocument</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">DeleteUserDocument</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@/type/graphql&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">useState</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;react&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">Page</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">loading</span><span class="p">,</span> <span class="nx">error</span> <span class="p">}</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="nx">useSubscription</span><span class="p">&lt;</span><span class="nt">SubscriptionUsersSubscription</span><span class="p">&gt;(</span><span class="nx">SubscriptionUsersDocument</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">[</span><span class="nx">createUser</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useMutation</span><span class="p">&lt;</span><span class="nt">CreateUserMutation</span><span class="p">&gt;(</span><span class="nx">CreateUserDocument</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">[</span><span class="nx">updateUser</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useMutation</span><span class="p">&lt;</span><span class="nt">UpdateUserMutation</span><span class="p">&gt;(</span><span class="nx">UpdateUserDocument</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">[</span><span class="nx">deleteUser</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useMutation</span><span class="p">&lt;</span><span class="nt">DeleteUserMutation</span><span class="p">&gt;(</span><span class="nx">DeleteUserDocument</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">[</span><span class="nx">newName</span><span class="p">,</span> <span class="nx">setNewName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="p">&gt;(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">[</span><span class="nx">editId</span><span class="p">,</span> <span class="nx">setEditId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">&lt;</span><span class="nt">number</span> <span class="err">|</span> <span class="na">null</span><span class="p">&gt;(</span><span class="kc">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">[</span><span class="nx">editName</span><span class="p">,</span> <span class="nx">setEditName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">&lt;</span><span class="nt">string</span><span class="p">&gt;(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">handleCreateUser</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">newName</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">await</span> <span class="nx">createUser</span><span class="p">({</span> <span class="nx">variables</span><span class="o">:</span> <span class="p">{</span> <span class="nx">name</span>: <span class="kt">newName</span> <span class="p">}</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">      <span class="nx">setNewName</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Error creating user:&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">handleEdit</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id</span>: <span class="kt">number</span><span class="p">,</span> <span class="nx">name</span>: <span class="kt">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setEditId</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setEditName</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">handleUpdateUser</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">editId</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="nx">editName</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">await</span> <span class="nx">updateUser</span><span class="p">({</span> <span class="nx">variables</span><span class="o">:</span> <span class="p">{</span> <span class="nx">id</span>: <span class="kt">editId</span><span class="p">,</span> <span class="nx">name</span>: <span class="kt">editName</span> <span class="p">}</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">      <span class="nx">setEditId</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">setEditName</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Error updating user:&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">handleDeleteUser</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">id</span>: <span class="kt">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">await</span> <span class="nx">deleteUser</span><span class="p">({</span> <span class="nx">variables</span><span class="o">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">}</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Error deleting user:&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">loading</span><span class="p">)</span> <span class="k">return</span> <span class="p">&lt;&gt;</span><span class="nx">loading</span><span class="p">...&lt;/&gt;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="k">return</span> <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nb">Error</span><span class="o">:</span> <span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Users</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">input</span>
</span></span><span class="line"><span class="cl">          <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">newName</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">setNewName</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">          <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Enter name&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleCreateUser</span><span class="p">}&gt;</span><span class="nx">Create</span> <span class="nx">User</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nx">data</span><span class="o">?</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">user</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">li</span> <span class="na">key</span><span class="o">=</span><span class="p">{</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">}&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="nx">editId</span> <span class="o">===</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span> <span class="o">?</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">              <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">input</span>
</span></span><span class="line"><span class="cl">                  <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="nx">editName</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="na">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">setEditName</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">                  <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Edit name&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleUpdateUser</span><span class="p">}&gt;</span><span class="nx">Save</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">setEditId</span><span class="p">(</span><span class="kc">null</span><span class="p">)}&gt;</span><span class="nx">Cancel</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">              <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span> <span class="o">:</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">              <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;{</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">handleEdit</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">)}&gt;</span>
</span></span><span class="line"><span class="cl">                  <span class="nx">Edit</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">handleDeleteUser</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">)}&gt;</span>
</span></span><span class="line"><span class="cl">                  <span class="nx">Delete</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">              <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)}</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">))}</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="nx">Page</span><span class="p">;</span>
</span></span></code></pre></div><hr>
<p>4.2
ä¸Šè¨˜ã®ã‚ˆã†ã«ä¿®æ­£ã—ãŸã‚‰<code>localhost:3000</code> ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦å‹•ä½œç¢ºèªã—ã¾ã™ã€‚</p>
<p>cssã‚’æ›¸ã„ã¦ã„ãªã„ã®ã§ã¨ã¦ã‚‚ç°¡ç´ ãªã‚‚ã®ã«ãªã£ã¦ã„ã¾ã™ãŒãƒ¦ãƒ¼ã‚¶ã®ä½œæˆã€ç·¨é›†ã€å‰Šé™¤ã‚’è¡Œã†ã¨ãã‚ŒãŒå³åº§ã«åæ˜ ã•ã‚Œã¦ã„ãŸã‚‰websocketãŒå‹•ã„ã¦ã„ã‚‹ã®ã§æˆåŠŸã«ãªã‚Šã¾ã™ã€‚
<img src="https://hackmd.io/_uploads/Hy7-52Ym1e.png" alt="image (4)"></p>
<hr>
<h3 id="ç’°å¢ƒæ§‹ç¯‰ä¸­ã«ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦">ç’°å¢ƒæ§‹ç¯‰ä¸­ã«ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦</h3>
<p>è‡ªå‹•ç”Ÿæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™ãŒrootã«ãªã£ã¦ã„ã¾ã—ãŸã€‚
ãã®å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ¨©é™ã‚’å¤‰æ›´ã—ã¦ã‚ã’ã¦ãã ã•ã„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo chown -R <span class="o">{</span>name<span class="o">}</span>:<span class="o">{</span>name<span class="o">}</span> <span class="o">{</span>folder_name<span class="o">}</span>
</span></span><span class="line"><span class="cl">sudo chmod <span class="m">755</span> <span class="o">{</span>file_name<span class="o">}</span>
</span></span></code></pre></div><h2 id="ä½™è«‡">ä½™è«‡</h2>
<p>BINGOãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚’ã¯ã˜ã‚ã¦2å¹´ãŒçµŒã¡ã¾ã™ãŒcode geneaterã‚’å°å…¥ã—ãŸã®ã¯ä»Šå¹´ã‹ã‚‰ã§ã—ãŸã€‚ãªã®ã§ã›ã£ã‹ããªã®ã§å°å…¥å‰ã¨å¾Œã®æ¯”è¼ƒã‚’è¡Œã„ã€è‡ªå‹•ç”Ÿæˆã¯ä½¿ã†ã¹ãã¨ã„ã†æ•™è¨“ã‚’çš†æ§˜ã«å…±æœ‰ã—ã¾ã™ã€‚</p>
<p>æ­£ç›´ä»Šã‚‚Graphql APIã¨REST APIã®é•ã„ã¯åˆ†ã‹ã‚‰ãšã«ä½¿ã£ã¦ã„ã¾ã™ãŒåˆæœŸã®é ƒã¯api_methodsã‚’ä½œæˆã—ã¦ã„ã¾ã—ãŸã€‚pageã§ã¯é–¢æ•°ã ã‘å‘¼ã³å‡ºã—ã¦ä½¿ã„ãŸã„ãŸã‚ã“ã“ã§Promiseã®å‡¦ç†ã‚’æ›¸ã„ãŸã‚Šã€å‹å®šç¾©ã‚’ã—ãŸã‚Šã¨æ›¸ã„ã¦ã„ã¾ã—ãŸã€‚</p>
<p>ã—ã‹ã—ã€generaterã‚’å°å…¥ã—ã¦ã‹ã‚‰ã¯ã‚¯ã‚¨ãƒªã‚’å®šç¾©ã™ã‚‹ã ã‘TSã«å¿…è¦ãªå‹å®šç¾©ã‚„apollo clientã«ã‚ˆã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ãŒç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã›ã£ã‹ãAPIã‚’hasuraãŒç°¡å˜ã«å®Ÿè£…ã—ã¦ãã‚Œã‚‹ã®ã«ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¸ã®ç¹‹ãè¾¼ã¿ã§æ™‚é–“ãŒã‹ã‹ã‚‹å•é¡Œã‚’è§£æ±ºã™ã‚‹ã«è‡³ã‚Šã¾ã—ãŸã€‚</p>
<p>å°å…¥å‰ã®AP
/src/utils/api_methods.ts</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">ApolloClient</span><span class="p">,</span> <span class="nx">InMemoryCache</span><span class="p">,</span> <span class="nx">gql</span><span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@apollo/client&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">next</span> <span class="kr">from</span> <span class="s2">&#34;next/types&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">GraphQLWsLink</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@apollo/client/link/subscriptions&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createClient</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;graphql-ws&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">userAgent</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;next/server&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">wsLink</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GraphQLWsLink</span><span class="p">(</span><span class="nx">createClient</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span>: <span class="kt">process.env.WS_API_URL</span> <span class="o">+</span> <span class="s2">&#34;/v1/graphql&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// èªè¨¼é–¢é€£ã¯ã“ã“ã«æ›¸ã
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ApolloClient</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">link</span>: <span class="kt">wsLink</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">cache</span>: <span class="kt">new</span> <span class="nx">InMemoryCache</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">interface</span> <span class="nx">BingoNumber</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">id</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">data</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// GraphQLã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="kr">async</span> <span class="kd">function</span> <span class="nx">getBingoNumber</span><span class="p">()</span><span class="o">:</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">BingoNumber</span><span class="err">[]</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">query</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">query</span>: <span class="kt">gql</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">        query MyQuery {
</span></span></span><span class="line"><span class="cl"><span class="sb">          bingo_number {
</span></span></span><span class="line"><span class="cl"><span class="sb">            data
</span></span></span><span class="line"><span class="cl"><span class="sb">            id
</span></span></span><span class="line"><span class="cl"><span class="sb">          }
</span></span></span><span class="line"><span class="cl"><span class="sb">        }
</span></span></span><span class="line"><span class="cl"><span class="sb">      `</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">bingo_number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Error fetching data:&#34;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// websocketé€šä¿¡ã§BingoNumberã‚’å–å¾—
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="kr">async</span> <span class="kd">function</span> <span class="nx">subscriptionBingoNumber</span><span class="p">()</span><span class="o">:</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">BingoNumber</span><span class="err">[]</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">query</span>: <span class="kt">gql</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">        subscription MySubscription {
</span></span></span><span class="line"><span class="cl"><span class="sb">          bingo_number {
</span></span></span><span class="line"><span class="cl"><span class="sb">            data
</span></span></span><span class="line"><span class="cl"><span class="sb">            id
</span></span></span><span class="line"><span class="cl"><span class="sb">          }
</span></span></span><span class="line"><span class="cl"><span class="sb">        }
</span></span></span><span class="line"><span class="cl"><span class="sb">      `</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">new</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">BingoNumber</span><span class="err">[]</span><span class="p">&gt;((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">response</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="nx">next</span>: <span class="kt">data</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">bingo_number</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="nx">error</span>: <span class="kt">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Subscription error:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="nx">reject</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error fetching data:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">async</span> <span class="kd">function</span> <span class="nx">createBingoNumber</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">data</span>: <span class="kt">number</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">:</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">BingoNumber</span><span class="err">[]</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">mutate</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">mutation</span>: <span class="kt">gql</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">        mutation MyMutation($data: Int!) {
</span></span></span><span class="line"><span class="cl"><span class="sb">          insert_bingo_number_one(object: { data: $data }) {
</span></span></span><span class="line"><span class="cl"><span class="sb">            id
</span></span></span><span class="line"><span class="cl"><span class="sb">          }
</span></span></span><span class="line"><span class="cl"><span class="sb">        }
</span></span></span><span class="line"><span class="cl"><span class="sb">      `</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">variables</span><span class="o">:</span> <span class="p">{</span> <span class="nx">data</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">insert_bingo_number_one</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Error creating bingo number:&#34;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">async</span> <span class="kd">function</span> <span class="nx">deleteBingoNumber</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">data</span>: <span class="kt">number</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">:</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">BingoNumber</span><span class="err">[]</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">mutate</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">mutation</span>: <span class="kt">gql</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">        mutation MyMutation($data: Int!) {
</span></span></span><span class="line"><span class="cl"><span class="sb">          delete_bingo_number(where: { data: { _eq: $data } }) {
</span></span></span><span class="line"><span class="cl"><span class="sb">            affected_rows
</span></span></span><span class="line"><span class="cl"><span class="sb">          }
</span></span></span><span class="line"><span class="cl"><span class="sb">        }
</span></span></span><span class="line"><span class="cl"><span class="sb">      `</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">variables</span><span class="o">:</span> <span class="p">{</span> <span class="nx">data</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">delete_bingo_number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Error deleteing bingo number:&#34;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å°å…¥å¾Œã®API
src/gql/numbers.gql</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gql" data-lang="gql"><span class="line"><span class="cl"><span class="c"># ç•ªå·ã®å–å¾—(Get)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">query</span><span class="w"> </span><span class="nc">GetListNumbers</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="py">numbers</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">number</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">createdAt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">updatedAt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># ç•ªå·ã®è¿½åŠ (Create)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">mutation</span><span class="w"> </span><span class="nc">CreateOneNumber</span><span class="p">(</span><span class="nv">$number</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">!)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="py">insertNumbersOne</span><span class="p">(</span><span class="py">object</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nc">number</span><span class="p">:</span><span class="w"> </span><span class="nv">$number</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nc">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># ç•ªå·ã®å‰Šé™¤(Delete)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">mutation</span><span class="w"> </span><span class="nc">DeleteOneNumber</span><span class="p">(</span><span class="nv">$number</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">!)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="py">deleteNumbers</span><span class="p">(</span><span class="py">where</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nc">number</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nc">_eq</span><span class="p">:</span><span class="w"> </span><span class="nv">$number</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nc">affectedRows</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># ç•ªå·ã®ç¶™ç¶šå–å¾—(Subscription)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">subscription</span><span class="w"> </span><span class="nc">SubscribeListNumbers</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="py">numbers</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">number</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">createdAt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="py">updatedAt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«</h2>
<p>ã“ã“ã¾ã§ã”ä¸€èª­ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚èª°ã‹ã®é–‹ç™ºã®ãƒ’ãƒ³ãƒˆã«ãªã£ã¦ã„ã‚Œã°å¹¸ã„ã§ã™ã€‚</p>
<p>ç§äº‹ã«ãªã‚Šã¾ã™ãŒã€NUTMEGã¯ä»Šå¹´ã‚‚å¤šãã®æ–°å…¥ç”Ÿã«æµã¾ã‚Œæ´»æ°—ã®ã‚ã‚‹å›£ä½“ã«ãªã‚Šã¾ã—ãŸã€‚ä»–å±€ã¨ã®ä¿¡é ¼é–¢ä¿‚ã‚‚ä¸€å±¤å¼·ã¾ã‚Šãƒ’ã‚¢ãƒªãƒ³ã‚°ã«å¯¾ã—ã¦çœŸæ‘¯ã«å¯¾å¿œã—ã¦ãã ã•ã‚‹ãŠã‹ã’ã§æ²¢å±±ã®ä¿®æ­£äº‹é …ã‚„æ”¹å–„äº‹é …ã‚’é ‚ãã¾ã—ãŸã€‚ä»Šã®æ–°å…¥ç”Ÿã®å‹¢ã„ã«è² ã‘ãªã„ã‚ˆã†ã«å¯„ã‚Šã‚ˆã‚Šãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚’å®Ÿç¾ãƒ»æä¾›ã§ãã‚‹ã‚ˆã†ã«æ´»å‹•ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚</p>
<p>æœ€å¾Œã«è¨€ã„ãŸã‹ã£ãŸã“ã¨ã¨ã—ã¦ã€çš†ã•ã‚“æ˜¯éGeneraterã«ã‚ˆã‚‹è‡ªå‹•ç”Ÿæˆã‚’ã†ã¾ãæ´»ç”¨ã—ã¦è‰¯ã„é–‹ç™ºãƒ©ã‚¤ãƒ•ã‚’ãŠé€ã‚Šãã ã•ã„ã€‚ä»Šã®æ™‚ä»£ã€æ´»ç”¨ã—ãŸã‚‚ã®å‹ã¡ã§ã™ã€‚</p>

        </div>

        
        
      </div>
    </div>
  </div>
</section>



<footer>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 text-center mb-5">
        <a href="https://blog.nutmeg.cloud/"><img src="https://blog.nutmeg.cloud/images/NUTMEG-logo_all_color_horizontal.png" alt="NUTMEG | é•·å²¡æŠ€è¡“ç§‘å­¦å¤§å­¦ æŠ€å¤§ç¥­å®Ÿè¡Œå§”å“¡ä¼š æƒ…å ±å±€"></a>
      </div>
      
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Social Contacts</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://twitter.com/nutfes_nutmeg">twitter</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://www.instagram.com/nutfes/?hl=ja">instagram</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://github.com/orgs/NUTFes">github</a></li>
          
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Categories</h6>
        <ul class="list-unstyled">
          <li class="mb-3"><a class="text-dark"
              href="https://blog.nutmeg.cloud/categories/nutmeg-advent-calendar-2023">Nutmeg advent calendar 2023</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="https://blog.nutmeg.cloud/categories/nutmeg-advent-calendar-2024">Nutmeg advent calendar 2024</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="https://blog.nutmeg.cloud/categories/%e3%82%a4%e3%83%99%e3%83%b3%e3%83%88">ã‚¤ãƒ™ãƒ³ãƒˆ</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="https://blog.nutmeg.cloud/categories/%e3%83%81%e3%83%bc%e3%83%a0%e3%81%a5%e3%81%8f%e3%82%8a">ãƒãƒ¼ãƒ ã¥ãã‚Š</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="https://blog.nutmeg.cloud/categories/%e3%83%a1%e3%83%b3%e3%83%90%e3%83%bc%e3%81%ae%e8%b6%a3%e5%91%b3">ãƒ¡ãƒ³ãƒãƒ¼ã®è¶£å‘³</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="https://blog.nutmeg.cloud/categories/%e5%af%be%e5%a4%96%e6%b4%bb%e5%8b%95">å¯¾å¤–æ´»å‹•</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="https://blog.nutmeg.cloud/categories/%e6%b4%bb%e5%8b%95%e3%81%ae%e6%a7%98%e5%ad%90">æ´»å‹•ã®æ§˜å­</a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://blog.nutmeg.cloud/about">About</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://blog.nutmeg.cloud/blog">Post</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://blog.nutmeg.cloud/products">Products</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://blog.nutmeg.cloud/members">Members</a></li>
          
        </ul>
      </div>
      <div class="col-12 border-top py-4 text-center">
        Â© NUTMEG 2024
      </div>
    </div>
  </div>
</footer>

<script>
  var indexURL = "https://blog.nutmeg.cloud/index.json"
</script>

<!-- JS Plugins -->

<script src="https://blog.nutmeg.cloud/plugins/jQuery/jquery.min.js"></script>

<script src="https://blog.nutmeg.cloud/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://blog.nutmeg.cloud/plugins/slick/slick.min.js"></script>

<script src="https://blog.nutmeg.cloud/plugins/venobox/venobox.min.js"></script>

<script src="https://blog.nutmeg.cloud/plugins/search/fuse.min.js"></script>

<script src="https://blog.nutmeg.cloud/plugins/search/mark.js"></script>

<script src="https://blog.nutmeg.cloud/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="https://blog.nutmeg.cloud/js/script.min.js"></script>


<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>


</body>
</html>